<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Console - Right Console</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #111;
            color: #fff;
            margin: 0;
            padding: 00px; /* Add padding to the body */
        }

      .top-frame {
            background-color: #1e1e1e;
            padding: 15px;
            margin-bottom: 3px; /* Add space below the header */
            display: flex; /* Use flexbox for layout */
            align-items: center; /* Vertically align items */
            justify-content: space-between; /* Distribute space between items */
        }

      .top-frame h2 {
            margin: 0;
            flex-grow: 1; /* Allow title to take up available space */
        }

      .buttons {
            display: flex; /* Use flexbox for button arrangement */
            gap: 10px; /* Add space between buttons */
        }

      .buttons button {
            background-color: #333; /* Example button color */
            color: #fff;
            border: none;
            padding: 0px 8px 0px 0px; /* Example button padding */
            border-radius: 20px; /* Example button border radius */
            cursor: pointer;
        }
        
      .buttons button img {  /* Target the image inside the button */
            max-width: 35px;
            max-height: 35px;
            margin-right: 5px;
            vertical-align: middle;
        }
        
      .buttons button:hover {
            background-color: #444;
        }

      .content-area {
            display: flex;
            height: calc(100vh - 95px); /* Adjust height to accommodate fixed top frame */
        }

      .left-content {
            width: 90%;
            overflow-y: auto; /* Add scroll to left content */
            margin-right: 10px; /* Add space between left and right content */
        }

        .left-content img {
            width: 100%;
            max-height: 60vh; /* Limit height to 60% of viewport height */
            object-fit: cover; /* Cover the container, maintaining aspect ratio */
            object-position: top; /* Align image to the top */
            animation: slideInLeft 1s ease-in-out;
        }
        
      .left-content::-webkit-scrollbar {
            width: 0px; /* Hide the scrollbar */
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
            }
            to {
                transform: translateX(0);
            }
        }

      .image-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3 equal-width columns */
            grid-gap: 0px; /* Adjust spacing as needed */
        }

        .image-grid button {
            background-color: transparent;
            border: none;
            padding: 0;
            margin: 1px;
            border-radius: 3px;
            transition: transform 0.3s ease; /* Add transition for smooth animation */
            cursor: pointer; /* Add cursor pointer */
        }

        .image-grid button:hover {
            transform: scale(.95); /* Scale the image by 5% on hover */
        }

        .image-grid button img {
            width: 100%;
            aspect-ratio: 1 / 1; /* Maintain square aspect ratio */
            object-fit: cover; /* Ensure images cover the container */
        }
        
      .image-grid img {
            width: 100%;
            aspect-ratio: 1 / 1; /* Maintain square aspect ratio */
            object-fit: cover; /* Ensure images cover the container */
            margin: 1px;
            border-radius: 3px;
        }

        .right-content {
            width: 10%;
            display: flex;
            flex-direction: column;
            gap: 5px;
            align-items: center;  /* Center the buttons horizontally */
        }

      .right-content button {
            background-color: transparent;
            color: white;
            border: none;
            margin-top: 15px;   /* Reduced margin-top */
            padding: 0;
            cursor: pointer;
            display: flex;     /* Enable flexbox for button content */
            align-items: center; /* Center icon and text vertically */
            transition: transform 0.3s ease; /* Add transition for smooth animation */
        }

      .right-content button img {
            max-width: 25px;
            max-height: 25px;
            margin-right: 0px;
        }
        
      .right-content button:hover {
            color: #111;
        }

        
        .right-content button:hover {
            transform: scale(.95); /* Scale the image by 5% on hover */
        }
        
      .image-grid button {
            background-color: transparent;
            border: none;
        }

        /* Emoji Popup Styles */
        .emoji-popup {
            position: absolute;
            top: 50%;
            left: 45%;
            transform: translate(-50%, -50%);
            width: 80%; /* Wider to accommodate columns */
            height: 70%;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            z-index: 1001;
            pointer-events: auto;
            display: none;
            overflow: hidden;
        }

        .emoji-popup .top-frame {
            background-color: #111;
            color: #fff;
            padding: 10px;
            text-align: center;
        }

        .emoji-popup .emoji-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            padding: 20px;
            overflow-y: scroll; /* Enable vertical scroll */
            scrollbar-width: none; /* Hide scrollbar */
            max-height: 60%;
        }

        .emoji-popup .emoji-grid::-webkit-scrollbar {
            display: none; /* Hide scrollbar for Chrome, Safari and Opera */
        }

        .emoji-popup .emoji-item {
            font-size: 2em;
            text-align: center;
            cursor: pointer;
            padding: 10px;
            border: 1px solid #333;
            border-radius: 5px;
        }

        .emoji-popup .emoji-item:hover {
            background-color: #444;
        }

        .emoji-popup .popup-footer {
            text-align: center;
            padding: 10px;
        }

        .emoji-popup .send-button {
            background-color: #333;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px; /* Lower the button */
        }

        .emoji-popup .send-button:hover {
            background-color: #444;
        }

        .emoji-popup .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            color: #fff;
        }

        .emoji-popup .close-button:hover {
            color: red;
        }
    </style>
</head>
<body>

    <div class="top-frame">
        <h2>The Grid</h2>
        <div class="buttons">
            <button><a href="dashboard.html" target="_parent"><img src="assets/portal_icon.png" alt="destiny"></a>PORTAL</button>
            
        </div>
    </div>

    <div class="content-area">
        <div class="left-content">
            <div class="image-grid" id="participant-grid">
            </div>
        </div>
        <div class="right-content">
            <button><img src="assets/grid_icon.png" alt="Grid Icon"></button>
            <button><img src="assets/list_icon.png" alt="List Icon"></button>
            <button><img src="assets/filter_icon.png" alt="Filter Icon"></button>
            <button><img src="assets/fave_icon.png" alt="Fave Icon"></button>
            <button><img src="assets/like_icon.png" alt="Like Icon"></button>
            <button><a href="../promoters_followers.html"></a><img src="assets/qr_icon.png" alt="QR Icon"></button>
        </div>
    </div>

    <div id="emojiPopup" class="emoji-popup" style="display: none;">
        <div class="top-frame">
            <h2>Intro</h2>
            <span class="close-button" onclick="closeEmojiPopup()">X</span>
        </div>
        <div class="emoji-grid" id="emojiGrid"></div>
        <div class="popup-footer">
            <button id="sendButton" class="send-button" onclick="sendEmojiToAvatar()">Send Emoji</button>
        </div>
    </div>

	<script>
        let selectedEmoji = null;

        function closeEmojiPopup() {
            document.getElementById('emojiPopup').style.display = 'none';
        }

        function showEmojiPopup() {
            document.getElementById('emojiPopup').style.display = 'block';
            fetchEmojis(); // Fetch emojis when the popup is shown
        }

        async function fetchEmojis() {
            try {
                const response = await fetch('emoji/emoji.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                const emojis = data.emojis;
                displayEmojis(emojis);
            } catch (error) {
                console.error('Could not fetch emojis:', error);
                document.getElementById('emojiGrid').innerHTML = '<p>Could not load emojis.</p>';
            }
        }

        function displayEmojis(emojis) {
            const emojiGrid = document.getElementById('emojiGrid');
            emojiGrid.innerHTML = ''; // Clear existing emojis
            emojis.forEach(emoji => {
                const emojiItem = document.createElement('div');
                emojiItem.classList.add('emoji-item');
                emojiItem.textContent = emoji;
                emojiItem.addEventListener('click', () => selectEmoji(emoji));
                emojiGrid.appendChild(emojiItem);
            });
        }

        
        function selectEmoji(emoji) {
            selectedEmoji = emoji;
            console.log('Selected emoji:', selectedEmoji);
        }

        function sendEmojiToAvatar() {
            if (selectedEmoji) {
                window.parent.document.getElementById('mainFrame').contentWindow.postMessage({ type: 'emoji', emoji: selectedEmoji }, '*');
                document.getElementById('sendButton').textContent = 'Emoji Sent';
                document.getElementById('sendButton').disabled = true;
                // Close the emoji popup
                closeEmojiPopup();
                // Show the "Emoji Sent" popup
                showEmojiSentPopup();
            }
        }

        function showEmojiSentPopup() {
            // Create the popup element
            const popup = document.createElement('div');
            popup.id = 'emojiSentPopup';
            popup.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: rgba(0, 0, 0, 0.8);
                color: #fff;
                padding: 20px;
                border-radius: 10px;
                z-index: 1001;
                text-align: center;
            `;
            popup.innerHTML = `
                <p>Emoji Sent!</p>
                <span class="close-button" onclick="closeEmojiSentPopup()" style="position: absolute; top: 10px; right: 10px; cursor: pointer; color: #fff;">X</span>
            `;

            // Append the popup to the body
            document.body.appendChild(popup);
        }

        function closeEmojiSentPopup() {
            const popup = document.getElementById('emojiSentPopup');
            popup.remove();
        }

        fetch('data/participant.json')
            .then(response => response.json())
            .then(data => {
                const participantGrid = document.getElementById('participant-grid');
                data.forEach(participant => {
                    const a = document.createElement('a');
                   
                    const button = document.createElement('button');
                    button.addEventListener('click', () => {
                        // Send participant data to leftconsole
                        const leftFrame = window.parent.document.getElementById('mainFrame');
                        leftFrame.contentWindow.postMessage({
                            type: 'participantSelected',
                            participant: participant
                        }, '*');
                    });

                    const img = document.createElement('img');
                    img.src = participant.image;
                    img.alt = participant.name;
                    button.appendChild(img);
                    a.appendChild(button);

                    participantGrid.appendChild(a);
                });
            });

        window.addEventListener('message', function(event) {
            if (event.data.type === 'showEmojiPopup') {
                showEmojiPopup();
            }
            if (event.data.type === 'closeEmojiPopup') {
                closeEmojiPopup();
            }
        });
    </script>
</body>
</html>
